#pragma once

#include "Globals.h"

extern U64 IndexToU64(int index, int bits, U64 bitboard);
extern U64 MaskB(int square);
extern U64 MaskR(int square);
extern U64 GenerateBishopAttacks(int square, U64 blockers);
extern U64 GenerateRookAttacks(int square, U64 blockers);

extern void FindMagics();

extern U64 AttackMasksB[64];
extern U64 AttackMasksR[64];

constexpr U64 NotFileA = 0xFEFEFEFEFEFEFEFEULL;
constexpr U64 NotFileAB = 0xFCFCFCFCFCFCFCFCULL;
constexpr U64 NotFileGH = 0x3F3F3F3F3F3F3F3FULL;
constexpr U64 NotFileH = 0x7F7F7F7F7F7F7F7FULL;

constexpr int RelevantBitsB[64] = {
    6, 5, 5, 5, 5, 5, 5, 6,
    5, 5, 5, 5, 5, 5, 5, 5,
    5, 5, 7, 7, 7, 7, 5, 5,
    5, 5, 7, 9, 9, 7, 5, 5,
    5, 5, 7, 9, 9, 7, 5, 5,
    5, 5, 7, 7, 7, 7, 5, 5,
    5, 5, 5, 5, 5, 5, 5, 5,
    6, 5, 5, 5, 5, 5, 5, 6
};

constexpr int RelevantBitsR[64] = {
    12, 11, 11, 11, 11, 11, 11, 12,
    11, 10, 10, 10, 10, 10, 10, 11,
    11, 10, 10, 10, 10, 10, 10, 11,
    11, 10, 10, 10, 10, 10, 10, 11,
    11, 10, 10, 10, 10, 10, 10, 11,
    11, 10, 10, 10, 10, 10, 10, 11,
    11, 10, 10, 10, 10, 10, 10, 11,
    12, 11, 11, 11, 11, 11, 11, 12
};

// constexpr U64 MagicsB[64] = {
//     0x2220940a1000100ULL, 0x880a001006440840ULL, 0x80800282830400ULL, 0x4a0a1080040180caULL,
//     0x4401120101c8400ULL, 0x40421d10c10020ULL, 0x208480a40102000ULL, 0x4008004b000cULL,
//     0x10000010020ac004ULL, 0x80005802400814ULL, 0x4200088008022121ULL, 0x1c20446481300021ULL,
//     0x9680244810000840ULL, 0x1100880102ULL, 0x503a084042201010ULL, 0x6080001822025044ULL,
//     0x900a0820002460ULL, 0x5008806200808128ULL, 0xd00420990200ULL, 0x1000800410818ULL,
//     0x9030042009040208ULL, 0x800010021142ULL, 0x4210200208020800ULL, 0x900480a411201240ULL,
//     0x20006826046008ULL, 0x93000c009050c852ULL, 0x4100024122298ULL, 0x40100c0100408ULL,
//     0x4201000202120ULL, 0x420471105000ULL, 0x2803001008432ULL, 0x8210c05300105400ULL,
//     0x40aa00800441400ULL, 0xa0200a008d00100ULL, 0x480080112236009ULL, 0x1010088c0c0ULL,
//     0x10104200004010ULL, 0x850040100400ULL, 0x20004a4018268ULL, 0x54031000212ULL,
//     0x220d085004414200ULL, 0xd080a0100a008ULL, 0x300c1088041ULL, 0x81042401040c808ULL,
//     0x2040400900400020ULL, 0x800890048160100ULL, 0x240890224001008ULL, 0x4150020880082ULL,
//     0x49060442021001ULL, 0x202088220100830ULL, 0x8021124002ULL, 0x104180000504000eULL,
//     0xa01008180411208ULL, 0x4208283050000ULL, 0x215018030a4188ULL, 0x2808008014149c0ULL,
//     0x1000240300c0108ULL, 0x610200400919a000ULL, 0x4000400040021301ULL, 0xc09012048240080ULL,
//     0x8e020a020007004ULL, 0x404000090104a402ULL, 0x804911002004422ULL, 0x840100020018ULL
// };

// constexpr U64 MagicsR[64] = {
//     0x18000804000a110ULL, 0x44005421000a000ULL, 0x4280200280100088ULL, 0x600041020400a00ULL,
//     0x2500040800421100ULL, 0x2600010804500200ULL, 0x4200520028040081ULL, 0x100004020810002ULL,
//     0x800800040008020ULL, 0x1040404000201000ULL, 0x208801000200086ULL, 0x6200800800801000ULL,
//     0x5020800400800800ULL, 0x8804804400800200ULL, 0x40040010b2110428ULL, 0xc240800040800100ULL,
//     0x20008080004000ULL, 0x890004020004011ULL, 0x200110020084100ULL, 0x4010010020090011ULL,
//     0x143030004080050ULL, 0x413808004000200ULL, 0x8000010100040200ULL, 0x12000081105cULL,
//     0x800080204004ULL, 0x6280200040100040ULL, 0x400200100104104ULL, 0x2110104200082201ULL,
//     0xe0080080800400ULL, 0x4054020080800400ULL, 0x5a10400481002ULL, 0x2000004200040091ULL,
//     0x80004000c02001ULL, 0x150022004404000ULL, 0x58120042002080ULL, 0x801000800802ULL,
//     0x110005000800ULL, 0x204a001042004884ULL, 0x8328529004000128ULL, 0x401001049000082ULL,
//     0x800800040008020ULL, 0x4000408201020028ULL, 0x7020001106410022ULL, 0x2108002010010100ULL,
//     0x4802002008120005ULL, 0x1008040002008080ULL, 0x100040200010100ULL, 0x829140c834a0011ULL,
//     0x4080400080002180ULL, 0x2210200040008a80ULL, 0x800802000100080ULL, 0x4210408100100ULL,
//     0x4080082040080ULL, 0x4200040080020080ULL, 0x6921000a00040500ULL, 0x4801210094004200ULL,
//     0x185a08000104301ULL, 0x181a04000db01ULL, 0x2404805340200a02ULL, 0x542080520900101ULL,
//     0x2002008900502ULL, 0x3000208040001ULL, 0x100025001080084ULL, 0x8940008824004102ULL
// };

constexpr U64 MagicsB[64] = {
	0x40040822862081ULL, 0x40810a4108000ULL, 0x2008008400920040ULL, 0x61050104000008ULL,
	0x8282021010016100ULL, 0x41008210400a0001ULL, 0x3004202104050c0ULL, 0x22010108410402ULL,
	0x60400862888605ULL, 0x6311401040228ULL, 0x80801082000ULL, 0x802a082080240100ULL,
	0x1860061210016800ULL, 0x401016010a810ULL, 0x1000060545201005ULL, 0x21000c2098280819ULL,
	0x2020004242020200ULL, 0x4102100490040101ULL, 0x114012208001500ULL, 0x108000682004460ULL,
	0x7809000490401000ULL, 0x420b001601052912ULL, 0x408c8206100300ULL, 0x2231001041180110ULL,
	0x8010102008a02100ULL, 0x204201004080084ULL, 0x410500058008811ULL, 0x480a040008010820ULL,
	0x2194082044002002ULL, 0x2008a20001004200ULL, 0x40908041041004ULL, 0x881002200540404ULL,
	0x4001082002082101ULL, 0x8110408880880ULL, 0x8000404040080200ULL, 0x200020082180080ULL,
	0x1184440400114100ULL, 0xc220008020110412ULL, 0x4088084040090100ULL, 0x8822104100121080ULL,
	0x100111884008200aULL, 0x2844040288820200ULL, 0x90901088003010ULL, 0x1000a218000400ULL,
	0x1102010420204ULL, 0x8414a3483000200ULL, 0x6410849901420400ULL, 0x201080200901040ULL,
	0x204880808050002ULL, 0x1001008201210000ULL, 0x16a6300a890040aULL, 0x8049000441108600ULL,
	0x2212002060410044ULL, 0x100086308020020ULL, 0x484241408020421ULL, 0x105084028429c085ULL,
	0x4282480801080cULL, 0x81c098488088240ULL, 0x1400000090480820ULL, 0x4444000030208810ULL,
	0x1020142010820200ULL, 0x2234802004018200ULL, 0xc2040450820a00ULL, 0x2101021090020ULL,
};

constexpr U64 MagicsR[64] = {
	0xa080041440042080ULL, 0xa840200410004001ULL, 0xc800c1000200081ULL, 0x100081001000420ULL,
	0x200020010080420ULL, 0x3001c0002010008ULL, 0x8480008002000100ULL, 0x2080088004402900ULL,
	0x800098204000ULL, 0x2024401000200040ULL, 0x100802000801000ULL, 0x120800800801000ULL,
	0x208808088000400ULL, 0x2802200800400ULL, 0x2200800100020080ULL, 0x801000060821100ULL,
	0x80044006422000ULL, 0x100808020004000ULL, 0x12108a0010204200ULL, 0x140848010000802ULL,
	0x481828014002800ULL, 0x8094004002004100ULL, 0x4010040010010802ULL, 0x20008806104ULL,
	0x100400080208000ULL, 0x2040002120081000ULL, 0x21200680100081ULL, 0x20100080080080ULL,
	0x2000a00200410ULL, 0x20080800400ULL, 0x80088400100102ULL, 0x80004600042881ULL,
	0x4040008040800020ULL, 0x440003000200801ULL, 0x4200011004500ULL, 0x188020010100100ULL,
	0x14800401802800ULL, 0x2080040080800200ULL, 0x124080204001001ULL, 0x200046502000484ULL,
	0x480400080088020ULL, 0x1000422010034000ULL, 0x30200100110040ULL, 0x100021010009ULL,
	0x2002080100110004ULL, 0x202008004008002ULL, 0x20020004010100ULL, 0x2048440040820001ULL,
	0x101002200408200ULL, 0x40802000401080ULL, 0x4008142004410100ULL, 0x2060820c0120200ULL,
	0x1001004080100ULL, 0x20c020080040080ULL, 0x2935610830022400ULL, 0x44440041009200ULL,
	0x280001040802101ULL, 0x2100190040002085ULL, 0x80c0084100102001ULL, 0x4024081001000421ULL,
	0x20030a0244872ULL, 0x12001008414402ULL, 0x2006104900a0804ULL, 0x1004081002402ULL,
};